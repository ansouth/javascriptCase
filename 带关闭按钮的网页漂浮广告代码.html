<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
    <title>带关闭按钮的网页漂浮广告代码</title>
    <style>
        .box{
            position: absolute;
            left: 311px; top: 815px;
            visibility :hidden;
        }
        .box span{
            cursor: pointer;
            color:red;
            font-weight:bold;
            position: absolute;top: 2px;right: 5px;
        }
    </style>
</head>
<body>
<div class="box" id="img" onmouseover="clearInterval(interval)" onmouseout="interval = setInterval('changePos()', delay)" align="right">
    <a href="#" target="_blank"><img border="0" src="pic_ad.jpg" onload="return imgzoom(this,600);" onclick="javascript:window.open(this.src);"/></a>
    <span  onclick="clearInterval(interval);img.style.visibility = 'hidden'">X</span>
</div>
<script>
    var xPos = 20;
    var yPos = document.body.clientHeight;
    var step = 1;
    var delay = 30;
    var height = 0;
    var Hoffset = 0;
    var Woffset = 0;
    var yon = 0;
    var xon = 0;
    var pause = true;
    var interval;
    img.style.top = yPos;
    function changePos() {
        width = document.body.clientWidth;
        height = document.body.clientHeight;
        Hoffset = img.offsetHeight;
        Woffset = img.offsetWidth;
        img.style.left = xPos + document.body.scrollLeft;
        img.style.top = yPos + document.body.scrollTop;
        if (yon) {
            yPos = yPos + step;
        }
        else {
            yPos = yPos - step;
        }
        if (yPos < 0) {
            yon = 1;
            yPos = 0;
        }
        if (yPos >= (height - Hoffset)) {
            yon = 0;
            yPos = (height - Hoffset);
        }
        if (xon) {
            xPos = xPos + step;
        }
        else {
            xPos = xPos - step;
        }
        if (xPos < 0) {
            xon = 1;
            xPos = 0;
        }
        if (xPos >= (width - Woffset)) {
            xon = 0;
            xPos = (width - Woffset);
        }
    }
    function start() {
        img.style.visibility = "visible";
        interval = setInterval('changePos()', delay);
    }
    start();
</script>
</body>
</html>